def apply2(f, arr, i):
    if i != length(arr):
        arr[i] := f(arr[i]);
        apply2(f, arr, i + 1);
        arr
    else:
        arr
and
def apply(f, arr):
    apply2(f, arr, 0)
and
def applytree(f):
    lambda arr: (
        if isarray(arr):
            apply(applytree(f), arr)
        else:
            f(arr)
    ) end
in
applytree(lambda x: (
    print(x);
    x * x
) end)([1, [2, [[[3, 4]]], 5], [[6, 7]], []])
